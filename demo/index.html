<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Load Query-Editor component. -->
    <script src="../lib/query-editor.js"></script>

    <script lang="javascript">
        // Ensure you run code after the document has initialized
        document.addEventListener("DOMContentLoaded", ()=> {

          // Initialize some mock data
          const dataSources = [
              {
                id:"1",
                name:"File 1",
                columns:[
                  {id:"firstname", name:"First Name"},
                  {id:"lastname", name:"Last Name"},
                ],
                  data:[
                    {firstname:"Rick", lastname:"James"},
                    {firstname:"Eddie", lastname:"Murphy"},
                  ]
              },
              {
                id:"2",
                name:"File 2",
                columns:[
                  {id:"firstname", name:"First Name"},
                  {id:"salary", name:"Salary"},
                ],
                  data:[
                    {firstname:"Rick", salary:"210000"},
                    {firstname:"Eddie", salary:"250000"},
                  ]
              }
          ];

          const queryConfig = {
            columns:[
            {
              type:"datasource",
              dataSourceId:"1",
              columnId:"firstname"
            },
            {
              type:"datasource",
              dataSourceId:"2",
              columnId:"salary"
            },
            ],
            join:{
              joinType:"fuzzy",
              left:{
                datasourceId:"1",
                columnId:"1"
              },
              left:{
                datasourceId:"2",
                columnId:"1"
              },
            }
          }

          // Create the component
          const editor = queryEditor.create({
              element:document.getElementById("query-editor"),
              state:{
                dataSources,
                queryConfig,
              }
          })

          // Trigger on specific events
          editor.on("click",()=>{
              console.log("Handled click event");
              // Get back the active state
              const outputState = editor.getState();
              console.log(outputState);
            }
          )

          // This is how you update the state externally
          editor.updateState({
            dataSources,
            queryConfig,
          })

      })
    </script>
  </head>
  <body>
    <h1>Hello</h1>

    <div id="query-editor"></div>
  </body>
</html>
